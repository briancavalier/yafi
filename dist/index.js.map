{"version":3,"file":null,"sources":["../src/fn.js","../src/FutureValue.js","../src/kill.js","../src/Task.js"],"sourcesContent":["// Typeclass delegation helpers\n\nexport const map = (f, a) =>\n  a && typeof a.map === 'function' ? a.map(f) : f(a)\n\nexport const lift2 = (f, a, b) =>\n  ap(map(a => b => f(a, b), a), b)\n\nexport const ap = (ab, a) =>\n  ab && typeof ab.ap === 'function' ? ab.ap(a) : ab(a)\n\nexport const apply = (f, a) => f(a)\n","import * as F from './fn'\n\n// at :: Time -> a -> FutureValue t a\n// Create a new FutureValue whose value arrived at time t\nexport const at = (t, x) => new FutureValue(t, x)\n\n// pending :: () -> FutureValue t a\n// Create a new FutureValue whose value hasn't yet arrived\nexport const pending = () => at(Infinity, undefined)\n\n// Conceptually, a FutureValue is a value that becomes known\n// at a specific time (the temperature outside next Tuesday at 5pm).\n// Neither the time nor value can be known until the time occurs.\n// Mechanically, here, it's a write-once, immutable container for a\n// (time, value) pair, that allows zero or more awaiters.\nclass FutureValue {\n  constructor(time, value) {\n    this.time = time\n    this.value = value\n    this.action = undefined\n    this.length = 0\n  }\n\n  map(f) {\n    return map(f, this)\n  }\n\n  write(t, x) {\n    setFuture(t, x, this)\n    return this\n  }\n}\n\nclass Never {\n  constructor() {\n    this.time = Infinity\n    this.value = undefined\n  }\n\n  map(f) {\n    return this\n  }\n\n  write(t, x) {\n    throw new Error('Can\\'t set never')\n  }\n}\n\nexport const never = new Never()\n\nexport const map = (f, future) =>\n  future.time < Infinity ? at(future.time, F.map(f,future.value))\n    : mapFuture(f, future, pending())\n\nfunction mapFuture(f, future, futureResult) {\n  when(new Map(f, futureResult), future)\n  return futureResult\n}\n\nclass Map {\n  constructor(f, future) {\n    this.f = f\n    this.future = future\n  }\n\n  run({ time, value }) {\n    this.future.write(time, F.map(this.f, value))\n  }\n}\n\n// Return a FutureValue that is equivalent to the earlier of\n// two FutureValue\nexport const earliest = (breakTie, fv1, fv2) =>\n  fv1.time === Infinity && fv2.time === Infinity\n    ? raceFutureWith(breakTie, fv1, fv2, pending()) // both pending\n    : earliestOf(breakTie, fv1, fv2) // one isn't pending\n\nconst raceFutureWith = (breakTie, fv1, fv2, futureResult) => {\n  const race = new Race(breakTie, fv1, fv2, futureResult)\n  when(race, fv1)\n  when(race, fv2)\n  return futureResult\n}\n\nconst earliestOf = (breakTie, fv1, fv2) =>\n  fv1.time === fv2.time\n    ? breakTie(fv1, fv2) ? fv1 : fv2\n    : fv1.time < fv2.time ? fv1 : fv2\n\nclass Race {\n  constructor (breakTie, fv1, fv2, future) {\n    this.breakTie = breakTie\n    this.fv1 = fv1\n    this.fv2 = fv2\n    this.future = future\n  }\n\n  run (fv) {\n    const { time, value } = earliestOf(this.breakTie, this.fv1, this.fv2)\n    this.future.write(time, value)\n  }\n}\n\n// Add an action to the awaiters for the provided future\n// or execute it immediately if the future's value is known\nfunction when(action, future) {\n  if(future.time < Infinity) {\n    action.run(future)\n  } if (future.action === undefined) {\n    future.action = action\n  } else {\n    future[future.length++] = action\n  }\n}\n\n// Run all the awaiting actions when a future value is set\nfunction runActions(future) {\n  future.action.run(future)\n  future.action = undefined\n\n  for (let i = 0; i < future.length; ++i) {\n    future[i].run(future)\n    future[i] = undefined\n  }\n}\n\n// Set the time and value of a future, triggering all awaiters\nfunction setFuture(t, x, future) {\n  if(future.time < Infinity) {\n    throw new Error('future already set')\n  }\n\n  future.time = t\n  future.value = x\n\n  if(future.action === undefined) {\n    return\n  }\n\n  runActions(future)\n}\n","// Create a kill that will call the provided kill function\n// with the provided key.\n// const timer = killWith(clearTimeout, setTimeout(timerFunc, ms))\n// timer.kill() // timerFunc won't be called\nexport const killWith = (kill, key) => new KillWith(kill, key)\n\nclass KillWith {\n  constructor (kill, key) {\n    this._kill = kill\n    this.key = key\n  }\n\n  kill () {\n    this._kill(this.key)\n  }\n}\n\n// Combine two kills into a new one that kills both\nexport const killBoth = (kill1, kill2) => new KillBoth(kill1, kill2)\n\nclass KillBoth {\n  constructor (kill1, kill2) {\n    this.kill1 = kill1\n    this.kill2 = kill2\n  }\n\n  kill () {\n    this.kill1.kill()\n    this.kill2.kill()\n  }\n}\n\nexport const neverKill = {\n  kill () {}\n}\n","import { pending } from './FutureValue'\nimport { killBoth, neverKill } from './kill'\nimport * as F from './fn'\n\n// task :: ((a -> ()) -> Kill) -> Task a\n// Create a Task that will produce a result by running a function\nexport const task = run =>\n  new Task(resolver, run)\n\n// run :: Task a -> (KillFunc, FutureValue a)\n// Execute a Task that will produce a result.  Returns a function to\n// kill the in-progress Task and a FutureValue representing the\n// eventual result.\nexport const runTask = task => {\n  const futureValue = pending()\n  const kill = task.run(Date.now, new SetFutureValue(futureValue))\n  return [kill, futureValue]\n}\n\n// race :: Task a -> Task a -> Task a\n// Given two Tasks, return a Task equivalent to the one that produces a\n// value earlier, and kill the other Task.\nexport const race = (t1, t2) =>\n  new Task(raceTasks, { t1, t2 })\n\n// lift2 :: (a -> b -> c) -> Task a -> Task b -> Task c\n// Combine the results of 2 tasks\nexport const lift2 = (abc, ta, tb) =>\n  new Task(lift2Tasks, { abc, ta, tb })\n\n// Task type\n// A composable unit of async work that produces a FutureValue\nclass Task {\n  constructor (runTask, state) {\n    this.runTask = runTask\n    this.state = state\n  }\n\n  map (ab) {\n    return new Task(mapTask, { ab, task: this })\n  }\n\n  ap (tfab) {\n    return lift2(F.apply, tfab, this)\n  }\n\n  chain (atb) {\n    return new Task(chainTask, { atb, task: this })\n  }\n\n  run (now, action) {\n    return this.runTask(now, action, this.state)\n  }\n}\n\n// Run a callback-accepting function to produce a result\nconst resolver = (now, action, run) =>\n  run(x => action.react(now(), x))\n\nclass SetFutureValue {\n    constructor (futureValue) {\n      this.futureValue = futureValue\n    }\n\n    react(t, x) {\n      return this.futureValue.write(t, x)\n    }\n}\n\n// A Task whose value is the mapped result of another Task\nconst mapTask = (now, action, { ab, task }) =>\n  task.run(now, new Mapped(ab, action))\n\nclass Mapped {\n  constructor (ab, action) {\n    this.ab = ab\n    this.action = action\n  }\n\n  react (t, x) {\n    return this.action.react(t, F.map(this.ab, x))\n  }\n}\n\n// Task that appends more work to another Task, taking the\n// previous Task's output as input\nconst chainTask = (now, action, { atb, task }) => {\n  const unlessKilled = new UnlessKilled(action);\n  return killBoth(unlessKilled, task.run(now, new Chained(now, atb, unlessKilled)))\n}\n\nclass Chained {\n  constructor (now, atb, action) {\n    this.now = now\n    this.atb = atb\n    this.action = action\n  }\n\n  react (t, x) {\n    const atb = this.atb\n    return atb(x).run(this.now, this.action)\n  }\n}\n\nclass UnlessKilled {\n  constructor (action) {\n    this.action = action\n  }\n\n  react (t, x) {\n    return this.action.react(t, x)\n  }\n\n  kill () {\n    this.action = emptyAction\n  }\n}\n\nconst emptyAction = {\n  react (t, x) {}\n}\n\nconst raceTasks = (now, action, { t1, t2 }) => {\n  const r1 = new Raced(action)\n  const r2 = new Raced(action)\n  r2.kill = t1.run(now, r1)\n  r1.kill = t2.run(now, r2)\n\n  return killBoth(r1.kill, r2.kill)\n}\n\nclass Raced {\n  constructor (action) {\n    this.kill = neverKill\n    this.action = action\n  }\n\n  react (t, x) {\n    this.kill.kill()\n    this.action.react(t, x)\n  }\n}\n\nconst lift2Tasks = (now, action, { abc, ta, tb }) => {\n  // TODO: find a better way\n  // Kinda gross: closing over too much and allocating 2 objects\n  let count = 2\n  const check = t =>\n    --count === 0 && action.react(t, F.lift2(abc, a.value, b.value))\n\n  const a = new LiftVar(check)\n  const b = new LiftVar(check)\n\n  return killBoth(ta.run(now, a), tb.run(now, b))\n}\n\n// mutable container to hold task results for in-flight\n// liftN operations\nclass LiftVar {\n  constructor (check) {\n    this.check = check\n    this.value = undefined\n  }\n\n  react (t, x) {\n    this.value = x\n    return this.check(t)\n  }\n}\n"],"names":["const","map","lift2","ap","F.map","let","F.apply","F.lift2"],"mappings":"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"}